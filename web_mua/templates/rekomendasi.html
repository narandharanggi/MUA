{% extends "base.html" %} {% block menu_rekomendasi %}current{% endblock %} {%
block content %}
<!-- Page Title -->
<section
  class="page-title style-two"
  style="background-image: url(../static/images/background/rekomendasi.jpg)"
>
  <div class="auto-container">
    <div class="content-box centred mr-0">
      <div class="title">
        <h1>Rekomendasi MUA</h1>
      </div>
    </div>
  </div>
</section>
<!-- End Page Title -->

<!-- category-details -->
<section class="category-details bg-color-2">
  <div class="auto-container">
    <div class="row clearfix">
      <div class="col-lg-4 col-md-12 col-sm-12 sidebar-side">
        <div class="default-sidebar category-sidebar">
          <div class="sidebar-search sidebar-widget">
            <div class="widget-title">
              <h3>Lokasi</h3>
            </div>
            <div class="widget-content">
              <div class="form-group form-alamat">
                <input
                  value=""
                  type="text"
                  class="form-control alamat"
                  placeholder="Kecamatan, Kabupaten, Provinsi"
                />
              </div>
            </div>
          </div>
          <div class="product-sidebar sidebar-widget">
            <div class="flex-product-widget">
              <div class="left-product-widget">
                <div class="widget-title">
                  <h3>Produk</h3>
                </div>
              </div>
              <div class="right-product-widget">
                <button type="submit" id="lihat_panduan" class="theme-btn-one" data-toggle="modal" data-target="#panduan">
                  Lihat Panduan
                </button>
              </div>
            </div>

            <!-- Modal -->
            <!-- The Modal -->
            <div class="modal" id="panduan">
              <div class="modal-dialog modal-dialog-scrollable">
                <div class="modal-content">
                
                  <!-- Modal Header -->
                  <div class="modal-header">
                    <h1 class="modal-title">Panduan</h1>
                    <button type="button" class="close" data-dismiss="modal">×</button>
                  </div>
                  
                  <!-- Modal body -->
                  <div class="modal-body">
                    <div class="tabbable">
                      <ul class="nav nav-tabs" role="tablist">
                          <li class="nav-item active">
                              <a class="nav-link active" href="#scolor" data-toggle="tab">
                                      Skin Color
                                  </a>
                          </li>
                          <li>
                              <a class="nav-link" href="#sundertone" data-toggle="tab">
                                      Skin Undertone
                                  </a>
                          </li>
                      </ul>
                    </div>

                    <div class="tab-content" id="tab-content">
                      <div class="tab-pane active" id="scolor">
                        <p class="text-justify">Secara umum, ada tiga kategori skin color atau skin tone, yaitu light, medium, dan dark. Skin tone adalah warna permukaan kulit yang langsung terlihat oleh mata, warna dari kulit ini diperngaruhi oleh jumlah melanin yaitu zat pigmen yang memberi warna pada kulit dan rambut. Semakin sedikit jumlah pigmen maka semakin terang warna kulit.</p>
                        <ul class="list-group list-group-flush">
                          <li class="list-group-item">Terang (Light): Warna kulit terang atau cerah cenderung secara historis berasal dari negara-negara yang sering menghadapi salju atau cuaca berawan. Orang yang lebih pucat biasanya sangat sensitif terhadap sinar matahari dan lebih mudah terbakar daripada mereka yang memiliki kulit lebih gelap.</li>
                          <li class="list-group-item">Sedang (Medium): Kulit medium Warna kulit ini memiliki tampilan warna krem netral hingga keemasan atau warna zaitun. Kulit medium sering disebut dengan istilah tan, kuning langsat, atau sawo matang.</li>
                          <li class="list-group-item">Gelap (Dark): Kulit gelap biasanya berasal dari bagian dunia yang paling banyak terpapar radiasi ultraviolet, seperti Timur Tengah, India, dan Afrika. </li>
                        </ul>
                      </div>
                      <div class="tab-pane" id="sundertone">
                        <p class="text-justify">Skin undertone terbagi menjadi 3 jenis, cool, warm, neutral. Skin undertone merupakan warna dasar kulit yang terdapat di bawah permukaan kulit. Meskipun skin tone dapat berubah – ubah dikarenakan faktor eksternal seperti pengaruh lingkungan dan sinar matahari, tetapi skin undertone akan tetap sama. </p>
                        <ul class="list-group list-group-flush">
                          <li class="list-group-item">Cool undertone: rona kulit tampak seperti merah dan merah muda dengan sedikit corak kebiruan.</li>
                          <li class="list-group-item">Warm undertone: rona kulit tampak seperti warna kuning, peachy, dan emas.</li>
                          <li class="list-group-item">Neutral undertone: rona kulit tampak seperti zaitun atau campuran seimbang dari cool dan dan warm. </li>
                        </ul>
                        <img src="../static/images/skin_color_undertone.jpeg" class="rounded" alt="">
                      </div>
                    </div>

                    
                  </div>
                  
                  <!-- Modal footer -->
                  <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Tutup</button>
                  </div>
                  
                </div>
              </div>
            </div>

            <div class="widget-content">
              <div class="form-group">
                <select
                  class="js-states form-control produk"
                  tabindex="-1"
                  style="display: none; width: 100%"
                  aria-placeholder="Masukkan Produk"
                >
                  <option></option>
                  {% for item in produk_items %}
                  <option value="{{ item.produk_makeup }}">
                    {{ item.produk_makeup }}
                  </option>
                  {% endfor %}
                </select>
              </div>

              <!-- <div class="form-group">
                <select
                  class="js-example-tokenizer js-states form-control shade"
                  multiple="multiple"
                  tabindex="-1"
                  style="display: none; width: 100%"
                >
                  <option></option>
                  <option value="Natural Putih">Natural/Putih</option>
                  <option value="Suntan Sawo Matang">Suntan/Sawo Matang</option>
                  <option value="Natural">Natural</option>
                  <option value="Light Beige">Light Beige</option>
                  <option value="TWC Beige">TWC Beige</option>
                  <option value="Strawberry Dougnout Pink">
                    Strawberry Dougnout/Pink
                  </option>
                  <option value="Hitam Black">Hitam/Black</option>
                  <option value="Dark Brown">Dark Brown</option>
                  <option value="Rose Bomb Pink Red">Rose Bomb/Pink Red</option>
                  <option value="Ruby Red Merah">Ruby Red/Merah</option>
                  <option value="Pink Orchid">Pink Orchid</option>
                </select>
              </div> -->

              <div class="form-group">
                <select
                  class="js-states form-control skin-color"
                  tabindex="-1"
                  style="display: none; width: 100%"
                  aria-placeholder="Masukkan Skin Color"
                >
                  <option></option>
                  <option value="Light">Light</option>
                  <option value="Medium">Medium</option>
                  <option value="Dark">Dark</option>
                </select>
              </div>

              <div class="form-group">
                <select
                  class="js-states form-control skin-undertone"
                  tabindex="-1"
                  style="display: none; width: 100%"
                  aria-placeholder="Masukkan Skin Undertone"
                >
                  <option></option>
                  <option value="Cool">Cool</option>
                  <option value="Neutral">Neutral</option>
                  <option value="Warm">Warm</option>
                </select>
              </div>

              <div class="card card-rec-summary">
                <div class="card-body product-summary">
                  <div class="child-product-summary">
                    <li class="none-product">Tidak ada produk</li>
                  </div>
                </div>
              </div>

              <div class="flex-product-widget bottom-product-widget">
                <div class="left-product-widget">
                  <div class="widget-title">
                  </div>
                </div>
                <div class="right-product-widget">
                  <button type="submit" id="save_produk" class="theme-btn-one">
                    Simpan
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="price-filter sidebar-widget">
            <div class="widget-title">
              <h3>Harga</h3>
            </div>
            <div class="default-form">
              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-text-first">Rp</span>
                  <input
                    value=""
                    type="number"
                    class="form-control harga"
                    placeholder="Masukkan Harga"
                    oninput="this.value = !!this.value && Math.abs(this.value) >= 1 ? Math.abs(this.value) : null"
                  />
                  <span class="input-group-text-last">.000</span>
                </div>
              </div>
            </div>
          </div>
          <div class="price-filter sidebar-ok">
            <div class="price-range">
              <div class="row clearfix">
                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                  <button type="submit" id="rekomendasi" class="theme-btn-one">
                    Rekomendasi
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-8 col-md-12 col-sm-12 content-side">
        <div class="item-shorting clearfix"></div>
        <div class="category-block wrapper grid browse-add">
          <div class="grid-item feature-style-two four-column pd-0">
            <div class="overlay">
              <div class="overlay__wrapper">
                  <div class="overlay__spinner">
                    <div class="spinner-border" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                  </div>
              </div>
            </div>
            <div class="row row-product clearfix" id="product-container"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- category-details end -->
{% endblock %} {% block scripts %}
<!-- jequery plugins -->
<script src="../static/js/jquery.js"></script>
<script src="../static/js/popper.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/owl.js"></script>
<script src="../static/js/wow.js"></script>
<script src="../static/js/validation.js"></script>
<script src="../static/js/jquery.fancybox.js"></script>
<script src="../static/js/appear.js"></script>
<script src="../static/js/scrollbar.js"></script>
<script src="../static/js/jquery.nice-select.min.js"></script>
<script src="../static/js/product-filter.js"></script>

<!-- main-js -->
<script src="../static/js/script.js"></script>

<!-- select -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.full.min.js"></script>

<script>
  // $(function () {
  //   $(".harga").keydown(function () {
  //     // Save old value.
  //     if (
  //       !$(this).val() ||
  //       (parseInt($(this).val()) <= 999999 && parseInt($(this).val()) >= 1)
  //     )
  //       $(this).data("old", $(this).val());
  //   });
  //   $(".harga").keyup(function () {
  //     // Check correct, else revert back to old value.
  //     if (
  //       !$(this).val() ||
  //       (parseInt($(this).val()) <= 999999 && parseInt($(this).val()) >= 1)
  //     );
  //     else $(this).val($(this).data("old"));
  //   });
  // });
  // $("#single-select-optgroup-field").select2({
  //   theme: "bootstrap-5",
  //   width: $(this).data("width")
  //     ? $(this).data("width")
  //     : $(this).hasClass("w-100")
  //     ? "100%"
  //     : "style",
  //   placeholder: $(this).data("placeholder"),
  // });

  // $(".js-example-basic-multiple").select2({
  //   theme: "bootstrap-5",
  // });

  $('#panduan').on('show.bs.modal', function (event) { 
    $(this).find('.nav a:first').tab('show');
  })

  // select
  $("select").select2();
  $(".produk").select2({
    placeholder: "Masukkan Produk",
  });
  $(".skin-color").select2({
    placeholder: "Masukkan Skin Color",
  });
  $(".skin-undertone").select2({
    placeholder: "Masukkan Skin Undertone",
  });
  let selected = [];
  function checker(value_array, input_value) {
    let prohibited = value_array;
    for (let i = 0; i < prohibited.length; i++) {
      if (input_value.indexOf(prohibited[i]) > -1) {
        return false;
      }
    }
    return true;
  }

  let clone_none_product = $(".none-product").clone;
  $("#save_produk").on("click", function () {
    let result_produk = $(".produk").val();
    let result_skin_color = $(".skin-color").val();
    let result_undertone = $(".skin-undertone").val();
    let join_result =
      result_produk + " - " + result_skin_color + " - " + result_undertone;
    if (result_skin_color && result_produk && result_undertone) {
      if (checker(selected, join_result) === true) {
        selected.push(join_result);
        $(".none-product").remove();
        $(".child-product-summary").append("<li>" + join_result + "</li>");
        $(".produk").val("").trigger("change");
        $(".skin-color").val("").trigger("change");
        $(".skin-undertone").val("").trigger("change");
      } else {
        alert("Data sudah ada");
      }
    } else {
      alert("Data ada yang kosong");
    }
  });

  let clone = $(".feature-block").clone();
  $(".feature-block").remove();
  $(".overlay").hide();
  $("#rekomendasi").on("click", function () {
    if (Array.isArray(selected) && selected.length) {
      let values = {
        alamat: $(".alamat").val(),
        harga: $(".harga").val(),
        produk: selected,
      };
      $.ajax({
        url: "/user/rekomendasi",
        type: "POST",
        data: values,
        beforeSend: function () {
          $(".overlay").show();
        },
        complete: function (data) {
          $(".overlay").hide();
        },
      }).done(function (response) {
        // for (let i = 0; i < response["nama_mua"].length; i++) {
        //   // $(".response")
        //   //   .append("<div/>", response["nama_mua"][i])
        //   //   .append("<div/>", response["alamat"][i])
        //   //   .append("<div/>", response["deskripsi"][i])
        //   //   .append("<div/>", response["rating"][i])
        //   //   .append("<div/>", response["jarak"][i]);
        //   let t_clone = clone.clone();
        //   t_clone.find("#container-nama-mua").text(response["nama_mua"][i]);
        //   t_clone
        //     .find("#container-lokasi-mua")
        //     .text(response["alamat"][i] + " (" + response["jarak"][i] + " km)");

        //   // let tmp_rating = t_clone.find("#rating");
        //   for (let j = 0; j < 5; j++) {
        //     if (j < response["rating"][i]) {
        //       t_clone
        //         .find("#rating")
        //         .append(
        //           "<li><i class='fa-solid fa-star' style='color: #FFD43B;'></i></li>"
        //         );
        //     } else {
        //       t_clone
        //         .find("#rating")
        //         .append(
        //           "<li><i class='fa-solid fa-star' style='color: #c3c6d1;'></i></li>"
        //         );
        //     }
        //   }
        //   // t_clone.find("#rating").append(tmp_rating);
        //   $("#product-container").append(t_clone);
        // }
        $("#product-container").append(response["htmlresponse"]);
      });
    } else {
      alert("Data tidak boleh kosong");
    }
  });
</script>

{% endblock %}
